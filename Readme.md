# Snowman

This is a quick and dirty project to help organise a secret-santa-esque thing my family do during Christmas dinner. The tradition started to help entertain the kids between finishing the main course of Christmas dinner and the main present giving sessions, but now is an excuse for getting each other joke presents. In previous years, my Grandma has assigned each member of the family someone to buy for, but to help reduce the number of things to do when we're organising Christmas and in the interest of keeping it secret for everyone, this project aims to automatically generate random and secret pairings between gift givers and gift receivers.


## Architecture

The project has a very simple architecture. Terraform is used to generate a simple static site, hosted in an AWS S3 bucket. As part of the terraform build, it runs a node.js script on the local machine to generate the mapping. This is generated by recursively creating attempts at the mapping until a mapping is generated in which every Christmas Dinner invitee is both buying for and receiving from someone, and no one is assigned to buy for themselves. The mapping is stored in a JSON file in the bucket which is downloaded with the site homepage. Once the user has chosen their name from a dropdown of attendees on the site homepage the first time they visit the site, the name of the person they're buying for is stored in a cookie which is queried every time the page renders. This makes it easy for people to not look at who the other people are buying for, but it also makes it easy to reset if someone were to, for example, accidentally choose the wrong name from the dropdown.


## Managing the site

The site is managed through terraform - in order to generate new **LIVE** mappings with the same invitees, run `terraform destroy` then `terraform apply` from `./terraform`. Alternatively, this can be done manually by running `node ../generator/index` from `./terraform`, and then manually copying the generated `invitees.json` and `snowmap.json` from `./site/js` into `./js` in the s3 bucket. The list of invitees used to generate these two files is stored in a constant in `./generator/index.js`.


## TODOs

- [x] Generate mappings
- [x] Display in static website
- [x] Use terraform to manage infrastructure
- [ ] Nice DNS name
- [ ] Get rid of JQuery
- [ ] Improve UI design
